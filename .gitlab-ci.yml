before_script:
  - export LANG=C
  - module load impi/5.1.3 intel/16.0 gcc/4.9 mkl/11.3 autotools pkg-config python33/python/3.3
  - module list
  - env

# define two stages, that way coverage only runs after all other
# tests have been done.
stages:
  - test
  - coverage

# autogenerated tests

intel-double-precision-mpi-noomp-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - ./gitlab_ci_test

# print coverage results
total_coverage:
  stage: coverage
  tags:
    - cpu
  script:
    - ./ci_coverage_summary
  artifacts:
    paths:
      - coverage_data


before_script:
  - export LANG=C
  - ulimit -s unlimited
  - if [ $HOST != "hydra03" -a $HOST != "hydra04" -a $HOST != "hydra05"  -a $HOST != "hydra06"  -a $HOST != "hydra07"  -a $HOST != "knl1" -a $HOST != "knl2" -a $HOST != "knl3" -a $HOST != "knl4" ] ; then module load impi/5.1.3 intel/16.0 gcc/4.9 mkl/11.3 autotools pkg-config ; fi
  - if [ $HOST == "knl1" -o $HOST == "knl2" -o $HOST == "knl3" -o $HOST == "knl4" ] ; then module load impi/5.1.3 intel/17.0 gcc/6.3 mkl/2017 pkg-config ; fi
  - module list
  - export MKL_INTEL_SCALAPACK_MPI_NO_OMP_BASELINE="-L$MKL_HOME/lib/intel64 -lmkl_scalapack_lp64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm"
  - export MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP="$MKL_INTEL_SCALAPACK_MPI_NO_OMP_BASELINE -I$MKL_HOME/include/intel64/lp64"
  - export MKL_INTEL_SCALAPACK_LDFLAGS_MPI_NO_OMP="$MKL_INTEL_SCALAPACK_MPI_NO_OMP_BASELINE -Wl,-rpath,$MKL_HOME/lib/intel64"

  - export MKL_INTEL_SCALAPACK_MPI_OMP_BASELINE="-L$MKL_HOME/lib/intel64 -lmkl_scalapack_lp64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm"
  - export MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP="$MKL_INTEL_SCALAPACK_MPI_OMP_BASELINE -I$MKL_HOME/include/intel64/lp64"
  - export MKL_INTEL_SCALAPACK_LDFLAGS_MPI_OMP="$MKL_INTEL_SCALAPACK_MPI_OMP_BASELINE -Wl,-rpath,$MKL_HOME/lib/intel64"

  - export MKL_INTEL_SCALAPACK_NO_MPI_NO_OMP_BASELINE="-L$MKL_HOME/lib/intel64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lpthread -lm"
  - export MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP="$MKL_INTEL_SCALAPACK_NO_MPI_NO_OMP_BASELINE -I$MKL_HOME/include/intel64/lp64"
  - export MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP="$MKL_INTEL_SCALAPACK_NO_MPI_NO_OMP_BASELINE -Wl,-rpath,$MKL_HOME/lib/intel64"

  - export MKL_INTEL_SCALAPACK_NO_MPI_OMP_BASELINE="-L$MKL_HOME/lib/intel64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lpthread -lm"
  - export MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_OMP="$MKL_INTEL_SCALAPACK_NO_MPI_OMP_BASELINE -I$MKL_HOME/include/intel64/lp64"
  - export MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_OMP="$MKL_INTEL_SCALAPACK_NO_MPI_OMP_BASELINE -Wl,-rpath,$MKL_HOME/lib/intel64"

  - export MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP_BASELINE="-L$MKL_HOME/lib/intel64 -lmkl_scalapack_lp64 -lmkl_gf_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm"
  - export MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP="$MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP_BASELINE -I$MKL_HOME/include/intel64/lp64"
  - export MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_NO_OMP="$MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP_BASELINE -Wl,-rpath,$MKL_HOME/lib/intel64"

  - export MKL_GFORTRAN_SCALAPACK_MPI_OMP_BASELINE="-L$MKL_HOME/lib/intel64 -lmkl_scalapack_lp64 -lmkl_gf_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm"
  - export MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP="$MKL_GFORTRAN_SCALAPACK_MPI_OMP_BASELINE -I$MKL_HOME/include/intel64/lp64"
  - export MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP="$MKL_GFORTRAN_SCALAPACK_MPI_OMP_BASELINE -Wl,-rpath,$MKL_HOME/lib/intel64"

  - export MKL_GFORTRAN_SCALAPACK_NO_MPI_NO_OMP_BASELINE="-L$MKL_HOME/lib/intel64 -lmkl_gf_lp64 -lmkl_sequential -lmkl_core -lpthread -lm"
  - export MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP="$MKL_GFORTRAN_SCALAPACK_NO_MPI_NO_OMP_BASELINE -I$MKL_HOME/include/intel64/lp64"
  - export MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP="$MKL_GFORTRAN_SCALAPACK_NO_MPI_NO_OMP_BASELINE -Wl,-rpath,$MKL_HOME/lib/intel64"

  - export MKL_GFORTRAN_SCALAPACK_NO_MPI_OMP_BASELINE="-L$MKL_HOME/lib/intel64 -lmkl_gf_lp64 -lmkl_sequential -lmkl_core -lpthread -lm"
  - export MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_OMP="$MKL_GFORTRAN_SCALAPACK_NO_MPI_OMP_BASELINE -I$MKL_HOME/include/intel64/lp64"
  - export MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_OMP="$MKL_GFORTRAN_SCALAPACK_NO_MPI_OMP_BASELINE -Wl,-rpath,$MKL_HOME/lib/intel64"


# jobs for intel/gfortran double precision mpi and no openmp

intel-double-precision-mpi-noomp-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP" --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-double-precision-mpi-noomp-cuda-jobs-blocksize-32:
  tags:
    - gpu
  script:
    - module unload gcc
    - module load gcc/4.9 cuda
    - module list
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_NO_OMP -L$CUDA_HOME/lib64 -lcublas -I$CUDA_HOME/include" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP -L$CUDA_HOME/lib64 -lcublas -I$CUDA_HOME/include" CFLAGS="-O2"  FCFLAGS="-O1" --enable-gpu --with-cuda-path=$CUDA_HOME/ --disable-assumed-size --disable-sse --disable-sse-assembly --disable-avx --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - /home/elpa/bin/reserve_timeslot make check TEST_FLAGS='150 50 32'
    - cat test-suite.log
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-double-precision-mpi-noomp-cuda-jobs-blocksize-16:
  tags:
    - gpu
  script:
    - module unload gcc
    - module load gcc/4.9 cuda
    - module list
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_NO_OMP -L$CUDA_HOME/lib64 -lcublas -I$CUDA_HOME/include" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP -L$CUDA_HOME/lib64 -lcublas -I$CUDA_HOME/include" CFLAGS="-O2"  FCFLAGS="-O1" --enable-gpu --with-cuda-path=$CUDA_HOME/ --disable-assumed-size --disable-sse --disable-sse-assembly --disable-avx --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - /home/elpa/bin/reserve_timeslot make check TEST_FLAGS='150 50 16' 
    - cat test-suite.log
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-double-precision-nompi-noomp-cuda-jobs:
  tags:
    - gpu
  script:
    - module unload gcc
    - module load gcc/4.9 cuda
    - module list
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=ifort SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP -L$CUDA_HOME/lib64 -lcublas -I$CUDA_HOME/include" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP -L$CUDA_HOME/lib64 -lcublas -I$CUDA_HOME/include" CFLAGS="-O2"  FCFLAGS="-O1" --enable-gpu --with-cuda-path=$CUDA_HOME/ --with-mpi=0  --disable-sse --disable-sse-assembly --disable-avx --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - /home/elpa/bin/reserve_timeslot make check TEST_FLAGS='150 50 16'
    - cat test-suite.log
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-double-precision-mpi-noomp-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal CFLAGS="--coverage -O3 -mavx" FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --disable-avx2 FC=mpif90
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data
      #
      #gfortran-double-precision-mpi-noomp-assumed-size-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal CFLAGS="--coverage -O3 -mavx" FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --disable-assumed-size --disable-avx2 FC=mpif90
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

# jobs for intel/gfortran double precision mpi and no openmp

intel-single-precision-mpi-noomp-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-single-precision-mpi-noomp-cuda-jobs:
  tags:
    - gpu
  script:
    - module unload gcc
    - module load gcc/4.9 cuda
    - module list
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_NO_OMP -L$CUDA_HOME/lib64 -lcublas -I$CUDA_HOME/include" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP -L$CUDA_HOME/lib64 -lcublas -I$CUDA_HOME/include" CFLAGS="-O2"  FCFLAGS="-O1" --enable-gpu --with-cuda-path=$CUDA_HOME/ --enable-single-precision  --disable-sse --disable-sse-assembly --disable-avx --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - /home/elpa/bin/reserve_timeslot make check TEST_FLAGS='150 50 128'
    - cat test-suite.log
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-single-precision-mpi-noomp-cuda-jobs-blocksize-64:
  tags:
    - gpu
  script:
    - module unload gcc
    - module load gcc/4.9 cuda
    - module list
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_NO_OMP -L$CUDA_HOME/lib64 -lcublas -I$CUDA_HOME/include" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP -L$CUDA_HOME/lib64 -lcublas -I$CUDA_HOME/include" CFLAGS="-O2"  FCFLAGS="-O1" --enable-gpu --with-cuda-path=$CUDA_HOME/ --enable-single-precision  --disable-sse --disable-sse-assembly --disable-avx --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - /home/elpa/bin/reserve_timeslot make check TEST_FLAGS='150 50 64'
    - cat test-suite.log
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;


intel-single-precision-mpi-noomp-cuda-larger-jobs:
  tags:
    - gpu
  script:
    - module unload gcc
    - module load gcc/4.9 cuda
    - module list
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_NO_OMP -L$CUDA_HOME/lib64 -lcublas -I$CUDA_HOME/include" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP -L$CUDA_HOME/lib64 -lcublas -I$CUDA_HOME/include" CFLAGS="-O2"  FCFLAGS="-O1" --enable-gpu --with-cuda-path=$CUDA_HOME/ --enable-single-precision  --disable-sse --disable-sse-assembly --disable-avx --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - /home/elpa/bin/reserve_timeslot make check TEST_FLAGS='1500 500 128'
    - cat test-suite.log
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #intel-single-precision-mpi-noomp-cuda-runtime-choice-jobs:
      #  tags:
      #    - gpu
      #  script:
      #    - module unload gcc
      #    - module load gcc/4.9 cuda
      #    - module list
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_NO_OMP -L$CUDA_HOME/lib64 -lcublas -I$CUDA_HOME/include" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP -L$CUDA_HOME/lib64 -lcublas -I$CUDA_HOME/include" CFLAGS="-O2"  FCFLAGS="-O1" --enable-gpu --with-cuda-path=$CUDA_HOME/ --enable-single-precision  --disable-sse --disable-sse-assembly --disable-avx --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - export ELPA_USE_GPU=yes
      #    - export REAL_ELPA_KERNEL=REAL_ELPA_KERNEL_GPU
      #    - export COMPLEX_ELPA_KERNEL=COMPLEX_ELPA_KERNEL_GPU
      #    - /home/elpa/bin/reserve_timeslot make check TEST_FLAGS='150 50 128' || { cat test-suite.log; exit 1; }

      #intel-single-precision-mpi-noomp-cuda-blocksize-jobs:
      #  tags:
      #    - gpu
      #  script:
      #    - module unload gcc
      #    - module load gcc/4.9 cuda
      #    - module list
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_NO_OMP -L$CUDA_HOME/lib64 -lcublas -I$CUDA_HOME/include" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP -L$CUDA_HOME/lib64 -lcublas -I$CUDA_HOME/include" CFLAGS="-O2"  FCFLAGS="-O1" --enable-gpu --with-cuda-path=$CUDA_HOME/ --enable-single-precision  --disable-sse --disable-sse-assembly --disable-avx --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - export ELPA_USE_GPU=yes
      #    - export REAL_ELPA_KERNEL=REAL_ELPA_KERNEL_GPU
      #    - export COMPLEX_ELPA_KERNEL=COMPLEX_ELPA_KERNEL_GPU
      #    - /home/elpa/bin/reserve_timeslot make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }

intel-single-precision-nompi-noomp-cuda-jobs:
  tags:
    - gpu
  script:
    - module unload gcc
    - module load gcc/4.9 cuda
    - module list
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=ifort SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP -L$CUDA_HOME/lib64 -lcublas -I$CUDA_HOME/include" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP -L$CUDA_HOME/lib64 -lcublas -I$CUDA_HOME/include" CFLAGS="-O2"  FCFLAGS="-O1" --enable-gpu --with-cuda-path=$CUDA_HOME/ --enable-single-precision --with-mpi=0  --disable-sse --disable-sse-assembly --disable-avx --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - /home/elpa/bin/reserve_timeslot make check TEST_FLAGS='150 50 128'
    - cat test-suite.log
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-single-precision-nompi-noomp-cuda-larger-jobs:
  tags:
    - gpu
  script:
    - module unload gcc
    - module load gcc/4.9 cuda
    - module list
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=ifort SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP -L$CUDA_HOME/lib64 -lcublas -I$CUDA_HOME/include" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP -L$CUDA_HOME/lib64 -lcublas -I$CUDA_HOME/include" CFLAGS="-O2"  FCFLAGS="-O1" --enable-gpu --with-cuda-path=$CUDA_HOME/ --enable-single-precision --with-mpi=0  --disable-sse --disable-sse-assembly --disable-avx --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - /home/elpa/bin/reserve_timeslot make check TEST_FLAGS='1500 500 128'
    - cat test-suite.log
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;


      #gfortran-single-precision-mpi-noomp-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal CFLAGS="--coverage -O3 -mavx" FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --disable-avx2 FC=mpif90
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #     - coverage_data
      #
      #gfortran-single-precision-mpi-noomp-assumed-size-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal CFLAGS="--coverage -O3 -mavx" FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --disable-assumed-size --disable-avx2 FC=mpif90
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #     - coverage_data

# jobs for intel/gfortran double precision no mpi and no openmp

intel-double-precision-nompi-noomp-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --with-mpi=no FC=ifort --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-double-precision-nompi-noomp-larger-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --with-mpi=no FC=ifort --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='1000 50 32' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-double-precision-nompi-noomp-assumed-size-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --with-mpi=no  --disable-assumed-size FC=ifort --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-double-precision-nompi-noomp-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="--coverage -O3 -mavx" FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --with-mpi=no --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data
      #
      #gfortran-double-precision-nompi-noomp-assumed-size-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="--coverage -O3 -mavx" FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --with-mpi=no --disable-assumed-size --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

# jobs for intel/gfortran single precision no mpi and no openmp

intel-single-precision-nompi-noomp-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --with-mpi=0 --enable-single-precision FC=ifort --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-single-precision-nompi-noomp-assumed-size-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --with-mpi=0 --enable-single-precision --disable-assumed-size FC=ifort --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-nompi-noomp-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="--coverage -O3 -mavx" FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --with-mpi=0 --enable-single-precision --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data
      #
      #gfortran-single-precision-nompi-noomp-assumed-size-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="--coverage -O3 -mavx" FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --with-mpi=0 --enable-single-precision --disable-assumed-size --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data


# jobs for intel/gfortran double precision mpi and openmp

intel-double-precision-mpi-openmp-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-double-precision-mpi-openmp-assumed-size-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --disable-assumed-size --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-double-precision-mpi-openmp-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal  FC=mpif90 CFLAGS="-O3 -mavx" FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-double-precision-mpi-openmp-debug-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal  FC=mpif90 CFLAGS="-g3 -O3 -mavx"  FCFLAGS="-g3 -O3 -mavx -fcheck=all" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-double-precision-mpi-openmp-assumed-size-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal  FC=mpif90 CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --disable-assumed-size --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-double-precision-mpi-openmp-assumed-size-debug-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal  FC=mpif90 CFLAGS="-g3 -O3 -mavx"  FCFLAGS="-fcheck=all -g3 -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --disable-assumed-size --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-double-precision-mpi-openmp-special-gcov-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal  FC=mpif90 CFLAGS="--coverage -O3 -mavx" FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --disable-avx2
      #    - make -j 8
      #    - export OMP_NUM_THREADS=1
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

# jobs for intel/gfortran single precision mpi and openmp

intel-single-precision-mpi-openmp-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-single-precision-mpi-openmp-larger-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='1500 500 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-single-precision-mpi-openmp-assumed-size-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --disable-assumed-size --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-single-precision-mpi-openmp-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal  FC=mpif90 CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-single-precision-mpi-openmp-debug-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal  FC=mpif90 CFLAGS="-g3 -O3 -mavx"  FCFLAGS="-fcheck=all -g3 -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-single-precision-mpi-openmp-assumed-size-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal  FC=mpif90 CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --disable-assumed-size --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-single-precision-mpi-openmp-assumed-size-debug-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal  FC=mpif90 CFLAGS="-g3 -O3 -mavx"  FCFLAGS="-fcheck=all -g3 -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --disable-assumed-size --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;



      #gfortran-single-precision-mpi-openmp-special-gcov-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal  FC=mpif90 CFLAGS="--coverage -O3 -mavx" FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --disable-avx2
      #    - make -j 8
      #    - export OMP_NUM_THREADS=1
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'

# jobs for intel/gfortran double precision no mpi and openmp

intel-double-precision-nompi-openmp-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=no --enable-openmp FC=ifort --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-double-precision-nompi-openmp-assumed-size-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=no --enable-openmp  --disable-assumed-size FC=ifort --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-double-precision-nompi-openmp-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=no --enable-openmp --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-double-precision-nompi-openmp-assumed-size-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=no --enable-openmp --disable-assumed-size --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-double-precision-nompi-openmp-special-gcov-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="--coverage -O3 -mavx" FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=no --enable-openmp --disable-avx2
      #    - make -j 8
      #    - export OMP_NUM_THREADS=1
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      ##    - ./test_scripts/get_coverage_summary.sh

# jobs for intel/gfortran double precision no mpi and openmp

intel-single-precision-nompi-openmp-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=0 --enable-single-precision --enable-openmp FC=ifort --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-single-precision-nompi-openmp-assumed-size-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=0 --enable-single-precision --enable-openmp --disable-assumed-size FC=ifort --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-single-precision-nompi-openmp-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=0 --enable-single-precision --enable-openmp --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-single-precision-nompi-openmp-assumed-size-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=0 --enable-single-precision --enable-openmp --disable-assumed-size --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-nompi-openmp-special-gcov-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="--coverage -O3 -mavx" FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=0 --enable-single-precision --enable-openmp --disable-avx2
      #    - make -j 8
      #    - export OMP_NUM_THREADS=1
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      ##    - ./test_scripts/get_coverage_summary.sh

# jobs for intel/gfortran double precision mpi and no openmp ftimings enabled

intel-double-precision-mpi-noopenmp-ftimings-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-timings --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-double-precision-mpi-noopenmp-ftimings-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx" FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-timings --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      ##    - ./test_scripts/get_coverage_summary.sh

# jobs for intel/gfortran single precision mpi and no openmp ftimings enabled

intel-single-precision-mpi-noopenmp-ftimings-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --enable-timings --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-mpi-noopenmp-ftimings-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx" FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --enable-timings --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      ##    - ./test_scripts/get_coverage_summary.sh

# jobs for intel/gfortran double precision no mpi and no openmp ftimings enabled

intel-double-precision-nompi-noopenmp-ftimings-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --with-mpi=no --enable-timings FC=ifort --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-double-precision-nompi-noopenmp-ftimings-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="--coverage -O3 -mavx" FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --with-mpi=no --enable-timings --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      ##    - ./test_scripts/get_coverage_summary.sh

# jobs for intel/gfortran single precision no mpi and no openmp ftimings enabled

intel-single-precision-nompi-noopenmp-ftimings-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --with-mpi=0 --enable-single-precision --enable-timings FC=ifort --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-nompi-noopenmp-ftimings-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="--coverage -O3 -mavx" FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --with-mpi=0 --enable-single-precision --enable-timings --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

      #gfortran-single-precision-nompi-noopenmp-ftimings-assumed-size-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --with-mpi=0 --enable-single-precision --enable-timings --disable-assumed-size-arrays --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data


# jobs for intel/gfortran double precision no mpi and openmp ftimings enabled

intel-double-precision-nompi-openmp-ftimings-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=no --enable-timings --enable-openmp FC=ifort --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-double-precision-nompi-openmp-ftimings-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=no --enable-timings --enable-openmp --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-double-precision-nompi-openmp-ftimings-special-gcov-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=no --enable-timings --enable-openmp --disable-avx2
      #    - make -j 8
      #    - export OMP_NUM_THREADS=1
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data


# jobs for intel/gfortran single precision no mpi and no openmp ftimings enabled

intel-single-precision-nompi-noopenmp-ftimings-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --with-mpi=0 --enable-single-precision --enable-timings FC=ifort --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-single-precision-nompi-noopenmp-ftimings-assumed-size-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --with-mpi=0 --enable-single-precision --enable-timings --disable-assumed-size FC=ifort --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;


      #gfortran-single-precision-nompi-noopenmp-ftimings-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --with-mpi=0 --enable-single-precision --enable-timings --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'  || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data
      #
      #gfortran-single-precision-nompi-noopenmp-ftimings-assumed-size-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --with-mpi=0 --enable-single-precision --enable-timings --disable-assumed-size --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data


# jobs for intel/gfortran double precision no mpi and openmp ftimings enabled

intel-double-precision-nompi-openmp-ftimings-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=no --enable-timings --enable-openmp FC=ifort --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-double-precision-nompi-openmp-ftimings-assumed-size-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=no --enable-timings --enable-openmp --disable-assumed-size FC=ifort --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;


gfortran-double-precision-nompi-openmp-ftimings-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=no --enable-timings --enable-openmp --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-double-precision-nompi-openmp-ftimings-assumed-size-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=no --enable-timings --enable-openmp --disable-assumed-size --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;


      #gfortran-double-precision-nompi-openmp-ftimings-special-gcov-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=no --enable-timings --enable-openmp --disable-avx2
      #    - make -j 8
      #    - export OMP_NUM_THREADS=1
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

# jobs for intel/gfortran single precision no mpi and openmp ftimings enabled

intel-single-precision-nompi-openmp-ftimings-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=0 --enable-single-precision --enable-openmp --enable-timings FC=ifort --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-single-precision-nompi-openmp-ftimings-assumed-size-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=0 --enable-single-precision --enable-openmp --enable-timings --disable-assumed-size FC=ifort --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-nompi-openmp-ftimings-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=0 --enable-single-precision --enable-openmp --enable-timings --disable-avx2
      #    - make -j 8
      #    - export OMP_NUM_THREADS=2
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

gfortran-single-precision-nompi-openmp-ftimings-assumed-size-arrays-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=0 --enable-single-precision --enable-openmp --enable-timings --disable-assumed-size --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-nompi-openmp-ftimings-special-gcov-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=0 --enable-single-precision --enable-openmp --enable-timings --disable-avx2
      #    - make -j 8
      #    - export OMP_NUM_THREADS=1
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

# jobs for intel/gfortran double precision mpi and openmp ftimings enabled

intel-double-precision-mpi-openmp-ftimings-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-timings --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-double-precision-mpi-openmp-ftimings-assumed-size-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-timings --disable-assumed-size --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-double-precision-mpi-openmp-ftimings-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-timings --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - export OMP_NUM_THREADS=2
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-double-precision-mpi-openmp-ftimings-assumed-size-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-timings --disable-assumed-size --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - export OMP_NUM_THREADS=2
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-double-precision-mpi-openmp-ftimings-special-gcov-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-timings --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - export OMP_NUM_THREADS=1
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

# jobs for intel/gfortran single precision mpi and openmp ftimings enabled

intel-single-precision-mpi-openmp-ftimings-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-single-precision-mpi-openmp-ftimings-assumed-size-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --disable-assumed-size --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-mpi-openmp-ftimings-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS=" -O3 -mavx"  FCFLAGS=" -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --disable-avx2
      #    - make -j 8
      #    - export OMP_NUM_THREADS=2
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

gfortran-single-precision-mpi-openmp-ftimings-assumed-size-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS=" -O3 -mavx"  FCFLAGS=" -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --disable-assumed-size --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;


      #gfortran-single-precision-mpi-openmp-ftimings-special-gcov-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --disable-avx2
      #    - make -j 8
      #    - export OMP_NUM_THREADS=1
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

# jobs for intel/gfortran double precision mpi and no openmp ftimings and redirect enabled

intel-double-precision-mpi-noopenmp-ftimings-redirect-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-timings --enable-redirect --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-double-precision-mpi-noopenmp-ftimings-redirect-assumed-size-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-timings --enable-redirect --disable-assumed-size --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;


      #gfortran-double-precision-mpi-noopenmp-ftimings-redirect-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data
      #
      #gfortran-double-precision-mpi-noopenmp-ftimings-redirect-assumed-size-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --disable-assumed-size --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

# real generic simple, compex generic simple
intel-double-precision-mpi-openmp-ftimings-redirect-real-generic-simple-complex-generic-simple-kernel-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp  --enable-timings --enable-redirect --with-fixed-real-kernel=generic --with-fixed-complex-kernel=generic --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

# jobs for intel/gfortran single precision mpi and no openmp ftimings and redirect enabled

intel-single-precision-mpi-noopenmp-ftimings-redirect-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-timings --enable-redirect --enable-single-precision --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-single-precision-mpi-noopenmp-ftimings-redirect-assumed-size-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-timings --enable-redirect --enable-single-precision --disable-assumed-size --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;


      #gfortran-single-precision-mpi-noopenmp-ftimings-redirect-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --enable-single-precision --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - export OMP_NUM_THREADS=1
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data
      #

      #gfortran-single-precision-mpi-noopenmp-ftimings-redirect-assumed-size-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --enable-single-precision --disable-assumed-size --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

# jobs for intel/gfortran double precision nompi and no openmp ftimings and redirect enabled

intel-double-precision-nompi-noopenmp-ftimings-redirect-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=ifort CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --enable-timings --enable-redirect --with-mpi=0 --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-double-precision-nompi-noopenmp-ftimings-redirect-assumed-size-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=ifort CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --enable-timings --enable-redirect --with-mpi=0 --disable-assumed-size --with-mpi=0 --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-double-precision-nompi-noopenmp-ftimings-redirect-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --with-mpi=0 --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data
      #
      #gfortran-double-precision-nompi-noopenmp-ftimings-redirect-assumed-size-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --with-mpi=0 --disable-assumed-size --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

# jobs for intel/gfortran single precision nompi and no openmp ftimings and redirect enabled

      #intel-single-precision-no-mpi-noopenmp-ftimings-redirect-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=0 --enable-single-precision --enable-openmp --enable-timings FC=ifort --disable-avx2
      #    - make -j 8
      #    - export OMP_NUM_THREADS=2
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

gfortran-single-precision-nompi-openmp-ftimings-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=0 --enable-single-precision --enable-openmp --enable-timings --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-nompi-openmp-ftimings-special-gcov-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_OMP" --with-mpi=0 --enable-single-precision --enable-openmp --enable-timings --disable-avx2
      #    - make -j 8
      #    - export OMP_NUM_THREADS=1
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #
      #gfortran-double-precision-mpi-openmp-ftimings-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-timings --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - export OMP_NUM_THREADS=2
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

      #gfortran-double-precision-mpi-openmp-ftimings-special-gcov-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-timings --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - export OMP_NUM_THREADS=1
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

# jobs for intel/gfortran single precision mpi and openmp ftimings enabled

intel-single-precision-mpi-openmp-ftimings-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-single-precision-mpi-openmp-ftimings-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS=" -O3 -mavx"  FCFLAGS=" -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-mpi-openmp-ftimings-special-gcov-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --disable-avx2
      #    - make -j 8
      #    - export OMP_NUM_THREADS=1
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }

intel-double-precision-mpi-noopenmp-ftimings-redirect-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-timings --enable-redirect --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-double-precision-mpi-noopenmp-ftimings-redirect-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

intel-single-precision-mpi-noopenmp-ftimings-redirect-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-timings --enable-redirect --enable-single-precision --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-mpi-noopenmp-ftimings-redirect-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --enable-single-precision --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #
      ## jobs for intel/gfortran double precision nompi and no openmp ftimings and redirect enabled
      #
      #intel-double-precision-nompi-noopenmp-ftimings-redirect-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --enable-timings --enable-redirect --with-mpi=0 FC=ifort --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

      #gfortran-double-precision-mpi-noopenmp-ftimings-redirect-real-avx_block2-complex-avx_block2-assumed-size-kernel:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --with-mpi=0 --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

# jobs for intel/gfortran single precision nompi and no openmp ftimings and redirect enabled

intel-single-precision-nompi-noopenmp-ftimings-redirect-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --enable-timings --enable-redirect --with-mpi=0 --enable-single-precision FC=ifort --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-nompi-noopenmp-ftimings-redirect-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --with-mpi=0 --enable-single-precision --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }

# jobs for intel/gfortran double precision mpi and openmp ftimings and redirect enabled

intel-double-precision-mpi-openmp-ftimings-redirect-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp  --enable-timings --enable-redirect --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - export OMP_NUM_THREADS=2
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-double-precision-mpi-openmp-ftimings-redirect-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-timings --enable-redirect --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - export OMP_NUM_THREADS=2
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-double-precision-mpi-openmp-ftimings-redirect-special-gcov-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-timings --enable-redirect --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - export OMP_NUM_THREADS=1
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

# jobs for intel/gfortran single precision mpi and openmp ftimings and redirect enabled

intel-single-precision-mpi-openmp-ftimings-redirect-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - export OMP_NUM_THREADS=2
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-single-precision-mpi-openmp-ftimings-redirect-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - export OMP_NUM_THREADS=2
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-mpi-openmp-ftimings-redirect-special-gcov-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - export OMP_NUM_THREADS=1
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

# jobs for intel/gfortran double precision nompi and openmp ftimings and redirect enabled

      #intel-double-precision-nompi-openmp-ftimings-redirect-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_OMP" --enable-openmp  --enable-timings --enable-redirect --with-mpi=0 FC=ifort --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - export OMP_NUM_THREADS=2
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

gfortran-double-precision-nompi-openmp-ftimings-redirect-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_OMP" --enable-openmp --enable-timings --enable-redirect --with-mpi=0 --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - export OMP_NUM_THREADS=2
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-double-precision-nompi-openmp-ftimings-redirect-special-gcov-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_OMP" --enable-openmp --enable-timings --enable-redirect --with-mpi=0 --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - export OMP_NUM_THREADS=1
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }

#step through kernels: real generic , complex generic
intel-single-precision-mpi-openmp-ftimings-redirect-real-generic-complex-generic-kernel-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=generic --with-fixed-complex-kernel=generic --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-single-precision-mpi-openmp-ftimings-redirect-real-generic-complex-generic-kernel-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=generic --with-fixed-complex-kernel=generic --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-mpi-openmp-ftimings-redirect-real-generic-complex-generic-kernel-special-gcov-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=generic --with-fixed-complex-kernel=generic --disable-avx2
      #    - make -j 8
      #    - export OMP_NUM_THREADS=1
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data


# jobs for intel/gfortran double precision mpi and no openmp ftimings and redirect enabled

#step through kernels: real generic , complex generic

intel-single-precision-mpi-noopenmp-ftimings-redirect-real-generic-complex-generic-kernel-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=generic --with-fixed-complex-kernel=generic --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-mpi-noopenmp-ftimings-redirect-real-generic-complex-generic-kernel-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=generic --with-fixed-complex-kernel=generic --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #
      #gfortran-double-precision-mpi-noopenmp-ftimings-redirect-real-generic-complex-generic-kernel-assumed-size-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP"  --enable-timings --enable-redirect --with-fixed-real-kernel=generic --with-fixed-complex-kernel=generic --disable-assumed-size --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

# real generic simple, compex generic simple

      #intel-single-precision-mpi-openmp-ftimings-redirect-real-generic-simple-complex-generic-simple-kernel-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=generic --with-fixed-complex-kernel=generic --disable-avx2
      #    - make -j 8
      #    - export OMP_NUM_THREADS=2
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

intel-double-precision-mpi-openmp-ftimings-redirect-real-generic-simple-complex-generic-simple-kernel-assumed-size-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp  --enable-timings --enable-redirect --with-fixed-real-kernel=generic_simple --with-fixed-complex-kernel=generic_simple --disable-assumed-size --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-single-precision-mpi-openmp-ftimings-redirect-real-generic-simple-complex-generic-simple-kernel-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=generic_simple --with-fixed-complex-kernel=generic_simple --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-mpi-openmp-ftimings-redirect-real-generic-simple-complex-generic-simple-kernel-special-gcov-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=generic --with-fixed-complex-kernel=generic --disable-avx2
      #    - make -j 8
      #    - export OMP_NUM_THREADS=1
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      ##    - ./test_scripts/get_coverage_summary.sh

# real generic simple, complex generic simple
intel-single-precision-mpi-noopenmp-ftimings-redirect-real-generic-simple-complex-generic-simple-kernel-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP"  --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=generic_simple --with-fixed-complex-kernel=generic_simple --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-mpi-noopenmp-ftimings-redirect-real-generic-simple-complex-generic-simple-kernel-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP"  --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=generic --with-fixed-complex-kernel=generic --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data
      #
      #gfortran-double-precision-mpi-noopenmp-ftimings-redirect-real-generic-simple-complex-generic-simple-kernel-assumed-size-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP"   --enable-timings --enable-redirect --with-fixed-real-kernel=generic --with-fixed-complex-kernel=generic --disable-assumed-size --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

# real sse assembly, complex sse assembly
intel-single-precision-mpi-openmp-ftimings-redirect-real-sse_assembly-complex-sse_assembly-kernel-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=sse_assembly --with-fixed-complex-kernel=sse_assembly --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-single-precision-mpi-openmp-ftimings-redirect-real-sse_assembly-complex-sse_assembly-kernel-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=sse_assembly --with-fixed-complex-kernel=sse_assembly --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-mpi-openmp-ftimings-redirect-real-sse_assembly-complex-sse_assembly-kernel-special-gcov-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=generic --with-fixed-complex-kernel=generic --disable-avx2
      #    - make -j 8
      #    - export OMP_NUM_THREADS=1
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #  tags:
      #    - cpu
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=generic --with-fixed-complex-kernel=generic --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }

      #gfortran-single-precision-mpi-noopenmp-ftimings-redirect-real-sse_assembly-complex-sse_assembly-kernel-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=generic --with-fixed-complex-kernel=generic --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

      #gfortran-double-precision-mpi-noopenmp-ftimings-redirect-real-sse_assembly-complex-sse_assembly-kernel-assumed-size-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP"  --enable-timings --enable-redirect --with-fixed-real-kernel=generic --with-fixed-complex-kernel=generic --disable-assumed-size --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

# real sse block2, complex sse block 1
intel-single-precision-mpi-openmp-ftimings-redirect-real-sse_block2-complex-sse_block1-kernel-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=sse_block2 --with-fixed-complex-kernel=sse_block1 --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-mpi-openmp-ftimings-redirect-real-sse_block2-complex-sse_block1-kernel-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=sse_block2 --with-fixed-complex-kernel=sse_block1 --disable-avx2
      #    - make -j 8
      #    - export OMP_NUM_THREADS=2
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data
      #
      #gfortran-single-precision-mpi-openmp-ftimings-redirect-real-sse_block2-complex-sse_block1-kernel-special-gcov-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=sse_block2 --with-fixed-complex-kernel=sse_block1 --disable-avx2
      #    - make -j 8
      #    - export OMP_NUM_THREADS=1
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      ##    - ./test_scripts/get_coverage_summary.sh
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data


# real sse block2, complex sse block1
intel-single-precision-mpi-noopenmp-ftimings-redirect-real-sse_block2-complex-sse_block1-kernel-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=sse_block2 --with-fixed-complex-kernel=sse_block1 --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-mpi-noopenmp-ftimings-redirect-real-sse_block2-complex-sse_block1-kernel-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=sse_block2 --with-fixed-complex-kernel=sse_block1 --disable-avx2
      #    - make -j 8
      #    - export OMP_NUM_THREADS=1
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      ##    - ./test_scripts/get_coverage_summary.sh

# real sse block4, complex sse block2

intel-single-precision-mpi-openmp-ftimings-redirect-real-sse_block4-complex-sse_block2-kernel-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=sse_block4 --with-fixed-complex-kernel=sse_block2 --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-single-precision-mpi-openmp-ftimings-redirect-real-sse_block4-complex-sse_block2-kernel-jobs:
  tags:
    - coverage
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-timings --enable-redirect --with-fixed-real-kernel=avx_block6 --with-fixed-complex-kernel=avx_block2 --enable-assumed-size --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='1500 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;
    - ./ci_coverage_collect
  artifacts:
    paths:
      - coverage_data

pure-intel-double-precision-mpi-noopenmp-ftimings-redirect-real-avx512_block2-complex-avx512_block1-kernel-jobs:
  tags:
    - KNL
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpiifort CC=mpiicc CFLAGS="-O3 -mtune=knl -axMIC-AVX512" FCFLAGS="-O3 -mtune=knl -axMIC-AVX512" SCALAPACK_FCFLAGS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm -I$MKLROOT/include/intel64/lp64" SCALAPACK_LDFLAGS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm -Wl,-rpath,$MKLROOT/lib/intel64" --with-fixed-real-kernel=avx512_block2  --with-fixed-complex-kernel=avx512_block1 --enable-avx512
    - /home/elpa/wait_until_midnight.sh
    - make -j 8
    - export OMP_NUM_THREADS=1
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    -  make check TEST_FLAGS='1000 500 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #intel-double-precision-mpi-noopenmp-ftimings-redirect-real-avx512_block2-complex-avx512_block1-kernel-jobs:
      #  tags:
      #    - KNL
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpiifort CFLAGS="-O3 -march=knl" FCFLAGS="-O3 -mtune=knl -axMIC-AVX512" SCALAPACK_FCFLAGS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm -I$MKLROOT/include/intel64/lp64" SCALAPACK_LDFLAGS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm -Wl,-rpath,$MKLROOT/lib/intel64" --with-fixed-real-kernel=avx512_block2  --with-fixed-complex-kernel=avx512_block1 --enable-avx512
      #    - /home/elpa/wait_until_midnight.sh
      #    - make -j 8
      #    - export OMP_NUM_THREADS=1
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    -  make check TEST_FLAGS='1000 500 16' || { cat test-suite.log; exit 1; }
      #    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-double-precision-mpi-noopenmp-ftimings-redirect-real-avx512_block2-complex-avx512_block1-kernel-jobs:
  tags:
    - KNL
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="-O3 -march=knl" FCFLAGS="-O3 -march=knl" SCALAPACK_FCFLAGS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_gf_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm -I$MKLROOT/include/intel64/lp64" SCALAPACK_LDFLAGS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_gf_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm -Wl,-rpath,$MKLROOT/lib/intel64" --with-fixed-real-kernel=avx512_block2  --with-fixed-complex-kernel=avx512_block1 --enable-avx512
    - /home/elpa/wait_until_midnight.sh
    - make -j 8
    - export OMP_NUM_THREADS=1
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    -  make check TEST_FLAGS='1000 500 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

pure-intel-single-precision-mpi-noopenmp-ftimings-redirect-real-avx512_block2-complex-avx512_block1-kernel-jobs:
  tags:
    - KNL
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpiifort CC=mpiicc CFLAGS="-O3 -mtune=knl -axMIC-AVX512" FCFLAGS="-O3 -mtune=knl -axMIC-AVX512" SCALAPACK_FCFLAGS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm -I$MKLROOT/include/intel64/lp64" SCALAPACK_LDFLAGS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm -Wl,-rpath,$MKLROOT/lib/intel64" --with-fixed-real-kernel=avx512_block2 --with-fixed-complex-kernel=avx512_block1 --enable-single-precision --enable-avx512
    - /home/elpa/wait_until_midnight.sh
    - make -j 8
    - export OMP_NUM_THREADS=1
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    -  make check TEST_FLAGS='1000 500 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #intel-single-precision-mpi-noopenmp-ftimings-redirect-real-avx512_block2-complex-avx512_block1-kernel-jobs:
      #  tags:
      #    - KNL
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpiifort CFLAGS="-O3 -march=knl" FCFLAGS="-O3 -mtune=knl -axMIC-AVX512" SCALAPACK_FCFLAGS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm -I$MKLROOT/include/intel64/lp64" SCALAPACK_LDFLAGS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm -Wl,-rpath,$MKLROOT/lib/intel64" --with-fixed-real-kernel=avx512_block2 --with-fixed-complex-kernel=avx512_block1 --enable-single-precision --enable-avx512
      #    - /home/elpa/wait_until_midnight.sh
      #    - make -j 8
      #    - export OMP_NUM_THREADS=1
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    -  make check TEST_FLAGS='1000 500 16' || { cat test-suite.log; exit 1; }
      #    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-single-precision-mpi-noopenmp-ftimings-redirect-real-avx512_block2-complex-avx512_block1-kernel-jobs:
  tags:
    - KNL
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="-O3 -march=knl" FCFLAGS="-O3 -march=knl" SCALAPACK_FCFLAGS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_gf_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm -I$MKLROOT/include/intel64/lp64" SCALAPACK_LDFLAGS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_gf_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm -Wl,-rpath,$MKLROOT/lib/intel64" --with-fixed-real-kernel=avx512_block2 --with-fixed-complex-kernel=avx512_block1 --enable-single-precision --enable-avx512
    - /home/elpa/wait_until_midnight.sh
    - make -j 8
    - export OMP_NUM_THREADS=1
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    -  make check TEST_FLAGS='1000 500 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-single-precision-mpi-noopenmp-ftimings-redirect-real-avx512_block2-complex-avx512_block1-kernel-debug-jobs:
  tags:
    - KNL
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpiifort CC=mpiicc CFLAGS="-O3 -mtune=knl -axMIC-AVX512" FCFLAGS="-g -C -traceback -zero -CA -CB  -check all,noarg_temp_created -O3 -mtune=knl -axMIC-AVX512" SCALAPACK_FCFLAGS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm -I$MKLROOT/include/intel64/lp64" SCALAPACK_LDFLAGS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm -Wl,-rpath,$MKLROOT/lib/intel64" --with-fixed-real-kernel=avx512_block2 --with-fixed-complex-kernel=avx512_block1 --enable-single-precision --enable-avx512
    - /home/elpa/wait_until_midnight.sh
    - make -j 8
    - export OMP_NUM_THREADS=1
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    -  make check TEST_FLAGS='1000 500 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

#real avx2 block2, complex avx2 block1 (emulated)

intel-single-precision-mpi-openmp-ftimings-redirect-real-avx2_block2-complex-avx2_block1-kernel-jobs:
  tags:
    - avx2
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -march=haswell -mavx2 -mfma" FCFLAGS="-O3 -march=core-avx2" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp  --enable-timings --enable-redirect --with-fixed-real-kernel=avx2_block2 --with-fixed-complex-kernel=avx2_block1 --enable-single-precision
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-single-precision-mpi-openmp-ftimings-redirect-real-avx2_block2-complex-avx2_block1-kernel-debug-jobs:
  tags:
    - avx2
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -march=haswell -mavx2 -mfma" FCFLAGS="-g -C -traceback -zero -CA -CB  -check all,noarg_temp_created -O3 -march=core-avx2" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp  --enable-timings --enable-redirect --with-fixed-real-kernel=avx2_block2 --with-fixed-complex-kernel=avx2_block1 --enable-single-precision
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

# real sse block4, complex sse block 2
intel-single-precision-mpi-noopenmp-ftimings-redirect-real-sse_block4-complex-sse_block2-kernel-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=sse_block4 --with-fixed-complex-kernel=sse_block2 --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-mpi-noopenmp-ftimings-redirect-real-sse_block4-complex-sse_block2-kernel-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=sse_block4 --with-fixed-complex-kernel=sse_block2 --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data
      #
      #gfortran-double-precision-mpi-noopenmp-ftimings-redirect-real-sse_block4-complex-sse_block2-kernel-assumed-size-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP"  --enable-timings --enable-redirect --with-fixed-real-kernel=sse_block4 --with-fixed-complex-kernel=sse_block2 --disable-assumed-size --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

# real sse block6, complex avx block1
#intel-single-precision-mpi-openmp-ftimings-redirect-real-sse_block6-complex-avx_block1-kernel-jobs:
#  tags:
#    - coverage
#  script:
#    - ./autogen.sh
#    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=sse_block6 --with-fixed-complex-kernel=avx_block1 --disable-avx2
#    - make -j 8
#    - export OMP_NUM_THREADS=2
#    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
#    - make check TEST_FLAGS='150 50 16'
#    - ./ci_coverage_collect
#  artifacts:
#    paths:
#      - coverage_data

gfortran-single-precision-mpi-openmp-ftimings-redirect-real-sse_block6-complex-avx_block1-kernel-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=sse_block6 --with-fixed-complex-kernel=avx_block1 --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-mpi-openmp-ftimings-redirect-real-sse_block6-complex-avx_block1-kernel-special-gcov-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=sse_block6 --with-fixed-complex-kernel=avx_block1 --disable-avx2
      #    - make -j 8
      #    - export OMP_NUM_THREADS=1
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      ##    - ./test_scripts/get_coverage_summary.sh

# real sse block6, complex avx block1
intel-single-precision-mpi-noopenmp-ftimings-redirect-real-sse_block6-complex-avx_block1-kernel-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP"  --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=sse_block6 --with-fixed-complex-kernel=avx_block1 --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-noopenmp-mpi-ftimings-redirect-real-sse_block6-complex-avx_block1-kernel-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP"  --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=sse_block6 --with-fixed-complex-kernel=avx_block1 --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data
      #
      #gfortran-double-precision-noopenmp-mpi-ftimings-redirect-real-sse_block6-complex-avx_block1-kernel-assumed-size-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP"   --enable-timings --enable-redirect --with-fixed-real-kernel=sse_block6 --with-fixed-complex-kernel=avx_block1 --disable-assumed-size --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

#real avx block2, complex avx block2
intel-single-precision-mpi-openmp-ftimings-redirect-real-avx_block2-complex-avx_block2-kernel-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=avx_block2 --with-fixed-complex-kernel=avx_block2 --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-single-precision-mpi-openmp-ftimings-redirect-real-avx_block2-complex-avx_block2-kernel-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=avx_block2 --with-fixed-complex-kernel=avx_block2 --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-mpi-openmp-ftimings-redirect-real-avx_block2-complex-avx_block2-kernel-special-gcov-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=avx_block2 --with-fixed-complex-kernel=avx_block2 --disable-avx2
      #    - make -j 8
      #    - export OMP_NUM_THREADS=1
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      ##    - ./test_scripts/get_coverage_summary.sh
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data


#real avx block2, complex avx block2
#intel-single-precision-mpi-noopenmp-ftimings-redirect-real-avx_block2-complex-avx_block2-kernel-jobs:
#  tags:
#    - coverage
#  script:
#    - ./autogen.sh
#    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=avx_block2 --with-fixed-complex-kernel=avx_block2 --disable-avx2
#    - make -j 8
#    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
#    - make check TEST_FLAGS='150 50 16'
#    - ./ci_coverage_collect
#  artifacts:
#    paths:
#      - coverage_data
#
#gfortran-single-precision-mpi-noopenmp-ftimings-redirect-real-avx_block2-complex-avx_block2-kernel-jobs:
#  tags:
#    - coverage
#  script:
#    - ./autogen.sh
#    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=avx_block2 --with-fixed-complex-kernel=avx_block2 --disable-avx2
#    - make -j 8
#    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
#    - make check TEST_FLAGS='150 50 16'
#
#gfortran-double-precision-mpi-noopenmp-ftimings-redirect-real-avx_block2-complex-avx_block2-assumed-size-kernel:
#  tags:
#    - coverage
#  script:
#    - ./autogen.sh
#    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-timings --enable-redirect --with-fixed-real-kernel=avx_block2 --with-fixed-complex-kernel=avx_block2  --disable-assumed-size --disable-avx2
#    - make -j 8
#    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
#    - make check TEST_FLAGS='150 50 16'
#    - ./ci_coverage_collect
#  artifacts:
#    paths:
#      - coverage_data

#real avx block4, complex avx block2
intel-single-precision-mpi-openmp-ftimings-redirect-real-avx_block4-complex-avx_block2-kernel-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=avx_block4 --with-fixed-complex-kernel=avx_block2 --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-single-precision-mpi-openmp-ftimings-redirect-real-avx_block4-complex-avx_block2-kernel-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=avx_block4 --with-fixed-complex-kernel=avx_block2 --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-mpi-openmp-ftimings-redirect-real-avx_block4-complex-avx_block2-kernel-special-gcov-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=avx_block4 --with-fixed-complex-kernel=avx_block2 --disable-avx2
      #    - make -j 8
      #    - export OMP_NUM_THREADS=1
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      ##    - ./test_scripts/get_coverage_summary.sh

#real avx block4, complex avx block2
intel-single-precision-mpi-noopenmp-ftimings-redirect-real-avx_block4-complex-avx-block2-kernel-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=avx_block4 --with-fixed-complex-kernel=avx_block2 --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-mpi-noopenmp-ftimings-redirect-real-avx_block4-complex-avx_block2-kernel-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=avx_block4 --with-fixed-complex-kernel=avx_block2 --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      #
      #gfortran-double-precision-mpi-noopenmp-ftimings-redirect-real-avx-block4-complex-avx_block2-kernel-assumed-size-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-timings --enable-redirect --with-fixed-real-kernel=avx_block4 --with-fixed-complex-kernel=avx_block2  --disable-assumed-size --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

#real avx block6, complex block 2
intel-single-precision-mpi-openmp-ftimings-redirect-real-avx_block6-complex-avx_block2-kernel-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=avx_block6 --with-fixed-complex-kernel=avx_block2 --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-single-precision-mpi-openmp-ftimings-redirect-real-avx_block6-complex-avx_block2-kernel-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=avx_block6 --with-fixed-complex-kernel=avx_block2 --disable-avx2
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-double-precision-mpi-noopenmp-ftimings-redirect-real-avx512_block4-complex-avx512_block2-kernel-jobs:
  tags:
    - KNL
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpiifort CC=mpiicc CFLAGS="-O3 -mtune=knl -axMIC-AVX512" FCFLAGS="-O3 -mtune=knl -axMIC-AVX512" SCALAPACK_FCFLAGS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm -I$MKLROOT/include/intel64/lp64" SCALAPACK_LDFLAGS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm -Wl,-rpath,$MKLROOT/lib/intel64" --with-fixed-real-kernel=avx512_block4 --with-fixed-complex-kernel=avx512_block2 --enable-avx512
    - /home/elpa/wait_until_midnight.sh
    - make -j 8
    - export OMP_NUM_THREADS=1
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    -  make check TEST_FLAGS='1000 500 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-single-precision-mpi-noopenmp-ftimings-redirect-real-avx512_block4-complex-avx512_block2-kernel-jobs:
  tags:
    - KNL
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpiifort CC=mpiicc CFLAGS="-O3 -mtune=knl -axMIC-AVX512" FCFLAGS="-O3 -mtune=knl -axMIC-AVX512" SCALAPACK_FCFLAGS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm -I$MKLROOT/include/intel64/lp64" SCALAPACK_LDFLAGS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm -Wl,-rpath,$MKLROOT/lib/intel64" --with-fixed-real-kernel=avx512_block4 --with-fixed-complex-kernel=avx512_block2 --enable-single-precision --enable-avx512
    - /home/elpa/wait_until_midnight.sh
    - make -j 8
    - export OMP_NUM_THREADS=1
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    -  make check TEST_FLAGS='1000 500 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

intel-double-precision-mpi-noopenmp-ftimings-redirect-real-avx512_block6-complex-avx512_block1-kernel-jobs:
  tags:
    - KNL
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpiifort CC=mpiicc CFLAGS="-O3 -mtune=knl -axMIC-AVX512" FCFLAGS="-O3 -mtune=knl -axMIC-AVX512" SCALAPACK_FCFLAGS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm -I$MKLROOT/include/intel64/lp64" SCALAPACK_LDFLAGS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm -Wl,-rpath,$MKLROOT/lib/intel64" --with-fixed-real-kernel=avx512_block6 --with-fixed-complex-kernel=avx512_block1 --enable-avx512
    - /home/elpa/wait_until_midnight.sh
    - make -j 8
    - export OMP_NUM_THREADS=1
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    -  make check TEST_FLAGS='1000 500 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

#real avx block6 , complex block2
intel-single-precision-mpi-noopenmp-ftimings-redirect-real-avx_block6-complex-avx_block2-kernel-jobs:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=avx_block6 --with-fixed-complex-kernel=avx_block2 --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-single-precision-mpi-nopenmp-ftimings-redirect-real-avx_block6-complex-avx_block2-kernel-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-single-precision --enable-timings --enable-redirect --with-fixed-real-kernel=avx_block6 --with-fixed-complex-kernel=avx_block2 --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data
      #
      #gfortran-double-precision-mpi-noopenmp-ftimings-redirect-real-avx_block6-complex-avx_block2-kernel-assumed-size-jobs:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --enable-timings --enable-redirect --with-fixed-real-kernel=avx_block6 --with-fixed-complex-kernel=avx_block2 --disable-assumed-size --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - make check TEST_FLAGS='150 50 16'
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

#real avx2 block2, complex avx2 block1 (emulated)

intel-single-precision-mpi-openmp-ftimings-redirect-real-avx2_block2-complex-avx2_block1-kernel-jobs:
  tags:
    - avx2
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -march=haswell -mavx2 -mfma" FCFLAGS="-O3 -march=core-avx2" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp  --enable-timings --enable-redirect --with-fixed-real-kernel=avx2_block2 --with-fixed-complex-kernel=avx2_block1 --enable-single-precision
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='100 25 16' || { cat test-suite.log; exit 1; }
      #    - /home/elpa/bin/sde-external-7.45.0-2016-05-09-lin/sde -hsw -- make check TEST_FLAGS='100 25 16'
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-single-precision-mpi-openmp-ftimings-redirect-real-avx2_block1-complex-avx2_block1-kernel-jobs:
  tags:
    - avx2
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="-O3 -march=haswell -mavx2 -mfma" FCFLAGS="-O3 -march=haswell -mavx2 -mfma" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp  --enable-timings --enable-redirect --with-fixed-real-kernel=avx2_block2 --with-fixed-complex-kernel=avx2_block1 --enable-single-precision
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='100 25 16' || { cat test-suite.log; exit 1; }
      # - /home/elpa/bin/sde-external-7.45.0-2016-05-09-lin/sde -hsw -- make check TEST_FLAGS='100 25 16'
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;


#real avx2 block2, complex avx2 block1 (emulated)

intel-single-precision-mpi-noopenmp-ftimings-redirect-real-avx2_block2-complex-avx2_block1-kernel-jobs:
  tags:
    - avx2
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-march=haswell -mavx2 -mfma" FCFLAGS="-O3 -march=core-avx2" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP"  --enable-timings --enable-redirect --with-fixed-real-kernel=avx2_block2 --with-fixed-complex-kernel=avx2_block1 --enable-single-precision
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='100 25 16' || { cat test-suite.log; exit 1; }
      #    - /home/elpa/bin/sde-external-7.45.0-2016-05-09-lin/sde -hsw -- make check TEST_FLAGS='100 25 16'
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;


#real avx2 block4, complex avx2 block2 (emulated)

intel-single-precision-mpi-openmp-ftimings-redirect-real-avx2_block4-complex-avx2_block2-kernel-jobs:
  tags:
    - avx2
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -march=haswell -mavx2 -mfma" FCFLAGS="-O3 -march=core-avx2" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp  --enable-timings --enable-redirect --with-fixed-real-kernel=avx2_block4 --with-fixed-complex-kernel=avx2_block2 --enable-single-precision
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='100 25 16' || { cat test-suite.log; exit 1; }
      # - /home/elpa/bin/sde-external-7.45.0-2016-05-09-lin/sde -hsw -- make check TEST_FLAGS='100 25 16'
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-single-precision-mpi-openmp-ftimings-redirect-real-avx2_block4-complex-avx2_block2-kernel-jobs:
  tags:
    - avx2
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="-O3 -march=haswell -mavx2 -mfma" FCFLAGS="-O3 -march=haswell -mavx2 -mfma" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp  --enable-timings --enable-redirect --with-fixed-real-kernel=avx2_block4 --with-fixed-complex-kernel=avx2_block2 --enable-single-precision
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='100 25 16' || { cat test-suite.log; exit 1; }
      # - /home/elpa/bin/sde-external-7.45.0-2016-05-09-lin/sde -hsw -- make check TEST_FLAGS='100 25 16'
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;



#real avx2 block4, complex avx2 block2 (emulated)

intel-single-precision-mpi-noopenmp-ftimings-redirect-real-avx2_block4-complex-avx2_block2-kernel-jobs:
  tags:
    - avx2
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-march=haswell -mavx2 -mfma" FCFLAGS="-O3 -march=core-avx2" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP"  --enable-timings --enable-redirect --with-fixed-real-kernel=avx2_block4 --with-fixed-complex-kernel=avx2_block2 --enable-single-precision
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - /home/elpa/bin/sde-external-7.45.0-2016-05-09-lin/sde -hsw -- make check TEST_FLAGS='100 25 16'
    - make check TEST_FLAGS='100 25 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      ##gfortran-single-precision-mpi-noopenmp-ftimings-redirect-real-avx2_block4-complex-avx2_block2-kernel-jobs:
      ##  tags:
      ##    - emulated
      ##  script:
      ##    - ./autogen.sh
      ##    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -march=haswell -mavx2 -mfma" FCFLAGS="--coverage -O3 -march=haswell -mavx2 -mfma" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP"  --enable-timings --enable-redirect --with-fixed-real-kernel=avx2_block4 --with-fixed-complex-kernel=avx2_block2 --enable-single-precision --disable-avx2
      ##    - make -j 8
      ##    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      ##    - /home/elpa/bin/sde-external-7.45.0-2016-05-09-lin/sde -hsw -- make check TEST_FLAGS='100 25 16'
      ###    - ./test_scripts/get_coverage_summary.sh


##real avx2 block6, complex avx2 block2

intel-single-precision-mpi-openmp-ftimings-redirect-real-avx2_block6-complex-avx2_block2-kernel-jobs:
  tags:
    - avx2
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -march=haswell -mavx2 -mfma" FCFLAGS="-O3 -march=core-avx2" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp  --enable-timings --enable-redirect --with-fixed-real-kernel=avx2_block6 --with-fixed-complex-kernel=avx2_block2 --enable-single-precision
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - /home/elpa/bin/sde-external-7.45.0-2016-05-09-lin/sde -hsw -- make check TEST_FLAGS='100 25 16'
    - make check TEST_FLAGS='100 25 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-single-precision-mpi-openmp-ftimings-redirect-real-avx2_block6-complex-avx2_block2-kernel-jobs:
  tags:
    - avx2
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="-O3 -march=haswell -mavx2 -mfma" FCFLAGS="-O3 -march=haswell -mavx2 -mfma" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp  --enable-timings --enable-redirect --with-fixed-real-kernel=avx2_block6 --with-fixed-complex-kernel=avx2_block2 --enable-single-precision
    - make -j 8
    - export OMP_NUM_THREADS=2
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - /home/elpa/bin/sde-external-7.45.0-2016-05-09-lin/sde -hsw -- make check TEST_FLAGS='100 25 16'
    - make check TEST_FLAGS='100 25 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      ##gfortran-single-precision-mpi-openmp-ftimings-redirect-real-avx2_block6-complex-avx2_block2-kernel-special-gcov-jobs:
      ##  tags:
      ##    - emulated
      ##  script:
      ##    - ./autogen.sh
      ##    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -march=haswell -mavx2 -mfma" FCFLAGS="--coverage -O3 -march=haswell -mavx2 -mfma" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp  --enable-timings --enable-redirect --with-fixed-real-kernel=avx2_block6 --with-fixed-complex-kernel=avx2_block2 --enable-single-precision --disable-avx2
      ##    - make -j 8
      ##    - export OMP_NUM_THREADS=1
      ##    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      ##    - /home/elpa/bin/sde-external-7.45.0-2016-05-09-lin/sde -hsw -- make check TEST_FLAGS='100 25 16'
      ###    - ./test_scripts/get_coverage_summary.sh


#real avx2 block6, complex avx2 block2 (emulated)

intel-single-precision-mpi-noopenmp-ftimings-redirect-real-avx2_block6-complex-avx2_block2-kernel-jobs:
  tags:
    - avx2
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-march=haswell -mavx2 -mfma" FCFLAGS="-O3 -march=core-avx2" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP"  --enable-timings --enable-redirect --with-fixed-real-kernel=avx2_block6 --with-fixed-complex-kernel=avx2_block2 --enable-single-precision
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - /home/elpa/bin/sde-external-7.45.0-2016-05-09-lin/sde -hsw -- make check TEST_FLAGS='100 25 16'
    - make check TEST_FLAGS='100 25 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      ##gfortran-single-precision-mpi-noopenmp-ftimings-redirect-real-avx2_block6-complex-avx2_block2-kernel-jobs:
      ##  tags:
      ##    - emulated
      ##  script:
      ##    - ./autogen.sh
      ##    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -march=haswell -mavx2 -mfma" FCFLAGS="--coverage -O3 -march=haswell -mavx2 -mfma" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP"  --enable-timings --enable-redirect --with-fixed-real-kernel=avx2_block6 --with-fixed-complex-kernel=avx2_block2 --enable-single-precision --disable-avx2
      ##    - make -j 8
      ##    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      ##    - /home/elpa/bin/sde-external-7.45.0-2016-05-09-lin/sde -hsw -- make check TEST_FLAGS='100 25 16'
      ###    - ./test_scripts/get_coverage_summary.sh

intel-single-precision-mpi-noopenmp-ftimings-redirect-real-avx512_block6-complex-avx512_block1-kernel-jobs:
  tags:
    - KNL
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpiifort CC=mpiicc CFLAGS="-O3 -mtune=knl -axMIC-AVX512" FCFLAGS="-O3 -mtune=knl -axMIC-AVX512" SCALAPACK_FCFLAGS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm -I$MKLROOT/include/intel64/lp64" SCALAPACK_LDFLAGS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm -Wl,-rpath,$MKLROOT/lib/intel64" --with-fixed-real-kernel=avx512_block6  --enable-single-precision --with-fixed-complex-kernel=avx512_block1 --enable-single-precision --enable-avx512
    - /home/elpa/wait_until_midnight.sh
    - make -j 8
    - export OMP_NUM_THREADS=1
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    -  make check TEST_FLAGS='1000 500 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;


intel-set-kernel-via-environment-variable-mpi-openmp-job:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - export REAL_ELPA_KERNEL=REAL_ELPA_KERNEL_GENERIC
    - export COMPLEX_ELPA_KERNEL=COMPLEX_ELPA_KERNEL_GENERIC
    - export OMP_NUM_THREADS=2
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-set-kernel-via-environment-variable-mpi-openmp-job:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - export REAL_ELPA_KERNEL=REAL_ELPA_KERNEL_GENERIC
    - export COMPLEX_ELPA_KERNEL=COMPLEX_ELPA_KERNEL_GENERIC
    - export OMP_NUM_THREADS=2
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-set-kernel-via-environment-variable-mpi-openmp-special-gcov-job:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_OMP" --enable-openmp --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - export REAL_ELPA_KERNEL=REAL_ELPA_KERNEL_GENERIC
      #    - export COMPLEX_ELPA_KERNEL=COMPLEX_ELPA_KERNEL_GENERIC
      #    - export OMP_NUM_THREADS=1
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      ##    - ./test_scripts/get_coverage_summary.sh
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

intel-set-kernel-via-environment-variable-mpi-noopenmp-job:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP" --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - export REAL_ELPA_KERNEL=REAL_ELPA_KERNEL_GENERIC
    - export COMPLEX_ELPA_KERNEL=COMPLEX_ELPA_KERNEL_GENERIC
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-set-kernel-via-environment-variable-mpi-noopenmp-job:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=mpif90 CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - export REAL_ELPA_KERNEL=REAL_ELPA_KERNEL_GENERIC
      #    - export COMPLEX_ELPA_KERNEL=COMPLEX_ELPA_KERNEL_GENERIC
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      ##    - ./test_scripts/get_coverage_summary.sh
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

intel-set-kernel-via-environment-variable-nompi-openmp-job:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_OMP" --enable-openmp --with-mpi=0 FC=ifort --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - export REAL_ELPA_KERNEL=REAL_ELPA_KERNEL_GENERIC
    - export COMPLEX_ELPA_KERNEL=COMPLEX_ELPA_KERNEL_GENERIC
    - export OMP_NUM_THREADS=2
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

gfortran-set-kernel-via-environment-variable-nompi-openmp-job:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="-O3 -mavx"  FCFLAGS="-O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_OMP" --enable-openmp --with-mpi=no --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - export REAL_ELPA_KERNEL=REAL_ELPA_KERNEL_GENERIC
    - export COMPLEX_ELPA_KERNEL=COMPLEX_ELPA_KERNEL_GENERIC
    - export OMP_NUM_THREADS=2
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-set-kernel-via-environment-variable-nompi-openmp-special-gcov-job:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_NO_MPI_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_OMP" --enable-openmp --with-mpi=no --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - export REAL_ELPA_KERNEL=REAL_ELPA_KERNEL_GENERIC
      #    - export COMPLEX_ELPA_KERNEL=COMPLEX_ELPA_KERNEL_GENERIC
      #    - export OMP_NUM_THREADS=1
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      ##    - ./test_scripts/get_coverage_summary.sh
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

intel-set-kernel-via-environment-variable-nompi-noopenmp-job:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --with-mpi=0 FC=ifort --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - export REAL_ELPA_KERNEL=REAL_ELPA_KERNEL_GENERIC
    - export COMPLEX_ELPA_KERNEL=COMPLEX_ELPA_KERNEL_GENERIC
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

      #gfortran-set-kernel-via-environment-variable-nompi-noopenmp-job:
      #  tags:
      #    - coverage
      #  script:
      #    - ./autogen.sh
      #    - ./configure --enable-option-checking=fatal FC=gfortran CFLAGS="--coverage -O3 -mavx"  FCFLAGS="--coverage -O3 -mavx" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP" --with-mpi=no --disable-avx2
      #    - make -j 8
      #    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
      #    - export REAL_ELPA_KERNEL=REAL_ELPA_KERNEL_GENERIC
      #    - export COMPLEX_ELPA_KERNEL=COMPLEX_ELPA_KERNEL_GENERIC
      #    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
      ##    - ./test_scripts/get_coverage_summary.sh
      #    - ./ci_coverage_collect
      #  artifacts:
      #    paths:
      #      - coverage_data

static-build:
  tags:
    - cpu
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal CFLAGS="-O3 -mavx" FCFLAGS="-O3 -axAVX" SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_NO_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_NO_MPI_NO_OMP"  --with-mpi=no FC=ifort --enable-shared=no --enable-static=yes --disable-avx2
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - make check TEST_FLAGS='150 50 16' || { cat test-suite.log; exit 1; }
    - grep -i "Expected %stop" test-suite.log && exit 1 || true ;

# test distcheck
distcheck:
  tags:
    - buildtest
  script:
    - ./autogen.sh
    - ./configure --enable-option-checking=fatal --with-mpi=no --disable-sse-assembly --disable-sse --disable-avx --disable-avx2
    # stupid 'make distcheck' leaves behind write-protected files that the stupid gitlab runner cannot remove
    - make distcheck DISTCHECK_CONFIGURE_FLAGS="--with-mpi=no --disable-sse-assembly --disable-sse --disable-avx --disable-avx2" TEST_FLAGS='150 50 16' || { chmod u+rwX -R . ; exit 1 ; }

# test test_project
test_project:
  tags:
    - buildtest
  script:
    - mkdir build
    - pushd build
    - ../autogen.sh
    - ../configure --enable-option-checking=fatal FCFLAGS="-march=native" CFLAGS="-march=native" --disable-avx2 SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" FC=mpif90 --prefix=$PWD/installdest --disable-avx2
    - make -j 8
    - make install
    - popd
    - mkdir test_project/build
    - pushd test_project/build
    - ../autogen.sh
    - ../configure --enable-option-checking=fatal PKG_CONFIG_PATH=../../build/installdest/lib/pkgconfig FC=mpif90
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - ./test_real
    - make distclean
    - popd
    - pushd build
    - make distclean
    - rm -rf installdest
    - popd

# test test_project_2stage
test_project_2stage:
  tags:
    - buildtest
  script:
    - mkdir build
    - pushd build
    - ../autogen.sh
    - ../configure --enable-option-checking=fatal FCFLAGS="-march=native" CFLAGS="-march=native" SCALAPACK_LDFLAGS="$MKL_GFORTRAN_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_GFORTRAN_SCALAPACK_FCFLAGS_MPI_NO_OMP" FC=mpif90 --prefix=$PWD/installdest --disable-avx2
    - make -j 8
    - make install
    - popd
    - mkdir test_project_2stage/build
    - pushd test_project_2stage/build
    - ../autogen.sh
    - ../configure --enable-option-checking=fatal PKG_CONFIG_PATH=../../build/installdest/lib/pkgconfig FC=mpif90
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - ./test_real2
    - make distclean
    - popd
    - pushd build
    - make distclean
    - rm -rf installdest
    - popd


## print coverage results
#total_coverage:
#  stage: coverage-summary
#  tags:
#    - coverage
#  script:
#    - ./ci_coverage_summary
#  artifacts:
#    paths:
#      - coverage_summary

test_project_intel:
  tags:
    - buildtest
  script:
    - mkdir build
    - pushd build
    - ../autogen.sh
    - ../configure --enable-option-checking=fatal SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP" FC=mpiifort --prefix=$PWD/installdest --disable-sse-assembly --disable-sse --disable-avx --disable-avx2
    - make -j 8
    - make install
    - popd
    - mkdir test_project/build
    - pushd test_project/build
    - ../autogen.sh
    - ../configure --enable-option-checking=fatal PKG_CONFIG_PATH=../../build/installdest/lib/pkgconfig FC=mpiifort
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - ./test_real
    - make distclean
    - popd
    - pushd build
    - make distclean
    - rm -rf installdest


test_project_2stage_intel:
  tags:
    - buildtest
  script:
    - mkdir build
    - pushd build
    - ../autogen.sh
    - ../configure --enable-option-checking=fatal SCALAPACK_LDFLAGS="$MKL_INTEL_SCALAPACK_LDFLAGS_MPI_NO_OMP" SCALAPACK_FCFLAGS="$MKL_INTEL_SCALAPACK_FCFLAGS_MPI_NO_OMP" FC=mpiifort --prefix=$PWD/installdest --disable-sse-assembly --disable-sse --disable-avx --disable-avx2
    - make -j 8
    - make install
    - popd
    - mkdir test_project_2stage/build
    - pushd test_project_2stage/build
    - ../autogen.sh
    - ../configure --enable-option-checking=fatal PKG_CONFIG_PATH=../../build/installdest/lib/pkgconfig FC=mpiifort
    - make -j 8
    - export LD_LIBRARY_PATH=$MKL_HOME/lib/intel64:$LD_LIBRARY_PATH
    - ./test_real2
    - make distclean
    - popd
    - pushd build
    - make distclean
    - rm -rf installdest
 
